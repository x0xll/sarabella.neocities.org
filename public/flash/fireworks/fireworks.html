<!DOCTYPE html>
<html>
    <head>
      <link rel="icon" href="/images/favicons/favicon.ico">
        <title data-il8n="game_firelightFestival">Firelight Festival</title>
        <script src="/ruffle/ruffle.js"></script>
        <script src="./js/fireworksExternalInterfaces.js"></script>
        <link rel="stylesheet" href="/styles.css">
    </head>

    <script src="/language.js"></script>

    <body class="game" onload="loadLanguagePref(); setupUserDropdown(); updateHighscore('FirelightFestival')">
      
        <script src="/header.js"></script>
        
        <div class="alert">
          <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
          <p data-il8n="firelight_warning">The game's text formatting is not yet correct, and the game isn't yet linked back with the viewer.</p>
        </div> 

        <script>
          // Gets the correct swf file from url
          const searchQueryString = window.location.search;
          const urlParameters = new URLSearchParams(searchQueryString);
          customFireworks = urlParameters.get('show')

          if (customFireworks == undefined)
            versionFile = 1
          else
            versionFile = 2
        </script>

        <div class="swf" dir="ltr" rbidi="on">
        </div>

        <p id="highscore" style="color: white; text-align: center;"><b>Highscore: </b></p>

        <div id="footer" class="footer">
          <script src="/footer.js"></script>
          <script>
            generateFooter({wikiLink: 'https://bellasara.wiki.gg/wiki/Firelight_Festival', githubLink: 'https://github.com/x0xll/sarabella.neocities.org/tree/main/public/flash/fireworks'});
          </script>
        </div>

        <script src="/flags.js"></script>
<script src="/userManager.js"></script>

        <script src="/flash/common/js/flashutils.js"></script>

        <!-- Load correct localized version of the game -->
        <script>
          setupRuffle();

          var locale = 'en';
          if (versionFile == 1)
          {
            locale = checkLocalizedFiles(`./lang/bs_firelightsfestival_${UTILS_LOCA_PATH_LANG_VALUE}.xml`);
          }
          else if (versionFile == 2)
          {
            locale = checkLocalizedFiles(`./lang/game_${UTILS_LOCA_PATH_LANG_VALUE}.xml`);
          }
          
          var pathXML = "lang/game_" + locale + ".xml";
          let swf = './swf/games/Fireworks' + versionFile + '.swf';
          if (locale == 'ja')
            swf = './swf/games/Fireworks' + versionFile + '_ja.swf';

          if (versionFile == 1)
            loadSWF(swf, '521', '887', locale)
          else if (versionFile == 2)
            loadSWF(swf, '521', '887', locale, `&xmlPath=${pathXML}&customShow=${customFireworks}`)
        </script>
  </body>
</html>